webpackJsonp([11],{QXeZ:function(t,e,s){e=t.exports=s("BkJT")(!1),e.push([t.i,"\n.el-input-group[data-v-5eb1ad57]{\r\n  width: 20%;\n}\n.cms-body .cms-form .flex-100[data-v-5eb1ad57],.cms-body .cms-form .flex-50[data-v-5eb1ad57]{\r\n  border-top: 1px dashed #eee;\n}\n.cms-body .cms-form .flex-no-border[data-v-5eb1ad57]{\r\n border-top: 0px dashed #eee;\n}\n.cms-body .cms-col1[data-v-5eb1ad57]{\r\n  width: 10%\n}\n.cms-body .cms-col2[data-v-5eb1ad57]{\r\n  width: 20%\n}\n.cms-body .cms-col3[data-v-5eb1ad57]{\r\n  width: 30%\n}\n.cms-body .cms-col4[data-v-5eb1ad57]{\r\n  width: 40%\n}\n.cms-body .cms-col5[data-v-5eb1ad57]{\r\n  width: 50%\n}\n.cms-body .cms-col6[data-v-5eb1ad57]{\r\n  width: 60%\n}\n.cms-body .cms-col7[data-v-5eb1ad57]{\r\n  width: 70%\n}\n.cms-body .cms-col8[data-v-5eb1ad57]{\r\n  width: 80%\n}\n.cms-body .cms-col9[data-v-5eb1ad57]{\r\n  width: 90%\n}\n.cms-body .cms-col10[data-v-5eb1ad57]{\r\n  width: 100%\n}\n.ftp-div[data-v-5eb1ad57]{\r\n  padding: 15px 0 15px 162px;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  font-size: 14px;\n}\n.ftp-item[data-v-5eb1ad57]{\r\n  background-color: #fbfdff;\r\n  border: 1px #eee dotted;\r\n  padding: 15px 15px ;\n}\n.ftp-item[data-v-5eb1ad57]{\r\n  line-height:50px;\n}\n.ftp-item > div >div[data-v-5eb1ad57]{\r\n  display: inline-block;\n}\n.gray[data-v-5eb1ad57]{\r\n  font-size: 14px;\n}\r\n",""])},jQSm:function(t,e,s){var a=s("QXeZ");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);s("8bSs")("82facf80",a,!0)},tv2R:function(t,e,s){"use strict";function a(t){s("jQSm")}Object.defineProperty(e,"__esModule",{value:!0});var n=s("HzJ8"),o=s.n(n),i=s("2sCs"),l=s.n(i),d=s("x1ym"),r=s("lcoF"),c={mixins:[r.a],data:function(){var t=d.a.required("此项必填");return{dataInfo:{},setps:[],roles:[],defaultRole:{},ftp_div_show:!1,rules:{name:[t],priority:[t,d.a.number("必须为数字")],cross:[t]}}},methods:{getParam:function(){var t=[],e=[];if(this.setps.length>0){var s=!0,a=!1,n=void 0;try{for(var i,l=o()(this.setps);!(s=(i=l.next()).done);s=!0){var d=i.value;t.push(d.roleId),e.push(d.countersign)}}catch(t){a=!0,n=t}finally{try{!s&&l.return&&l.return()}finally{if(a)throw n}}this.dataInfo.roleIds=t.join(","),this.dataInfo.countersigns=e.join(",")}delete this.dataInfo.events,delete this.dataInfo.nodes},getDataInfo:function(t){var e=this;this.$api;l.a.post(this.$api.workflowGet,{id:t}).then(function(t){e.loading=!1,e.dataInfo=t.body,l.a.post(e.$api.roleList).then(function(t){"200"==t.code&&(e.roles=t.body,t.body.length>0&&(e.defaultRole=t.body[0]))}),t.body.nodes.length>0&&(e.setps=t.body.nodes,e.ftp_div_show=e.setps.length>0)}).catch(function(t){e.loading=!1})},update:function(t){this.getParam(),this.updateDataInfo(this.$api.workflowUpdate,this.dataInfo,"list")},add:function(t){this.getParam(),this.saveDataInfo(t,this.$api.workflowSave,this.dataInfo,"list")},setpDelete:function(t){this.setps.splice(t,1),this.ftp_div_show=this.setps.length>0},setpAdd:function(){this.setps.push({countersign:!1,roleId:this.defaultRole.id,roleName:this.defaultRole.name}),this.ftp_div_show=this.setps.length>0}},created:function(){this.getDataInfo(this.id)}},p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"cms-body"},[s("cms-back"),t._v(" "),s("el-form",{ref:"form",staticClass:"cms-form",attrs:{model:t.dataInfo,rules:t.rules,"label-width":"162px"}},[s("el-form-item",{staticClass:"flex-100 ",attrs:{label:"名称",prop:"name"}},[s("el-input",{staticClass:"cms-width",model:{value:t.dataInfo.name,callback:function(e){t.$set(t.dataInfo,"name",e)},expression:"dataInfo.name"}})],1),t._v(" "),s("el-form-item",{staticClass:"flex-100",attrs:{label:"描述"}},[s("el-input",{staticClass:"cms-width",attrs:{type:"textarea"},model:{value:t.dataInfo.description,callback:function(e){t.$set(t.dataInfo,"description",e)},expression:"dataInfo.description"}})],1),t._v(" "),s("el-form-item",{staticClass:"flex-50 ",attrs:{label:"排序",prop:"priority"}},[s("el-input",{staticClass:"cms-width",attrs:{type:"number"},model:{value:t.dataInfo.priority,callback:function(e){t.$set(t.dataInfo,"priority",e)},expression:"dataInfo.priority"}})],1),t._v(" "),s("el-form-item",{staticClass:"flex-50 "}),t._v(" "),s("el-form-item",{staticClass:"flex-100 ",attrs:{label:"是否可以跨级审核",prop:"cross"}},[s("el-radio-group",{staticClass:"cms-width",model:{value:t.dataInfo.cross,callback:function(e){t.$set(t.dataInfo,"cross",e)},expression:"dataInfo.cross"}},[s("el-radio",{attrs:{label:!0}},[t._v("是")]),t._v(" "),s("el-radio",{attrs:{label:!1}},[t._v("否")])],1)],1),t._v(" "),s("el-form-item",{staticClass:"flex-100 ",attrs:{label:"工作流步骤"}},[s("el-button",{on:{click:t.setpAdd}},[t._v("增加")])],1),t._v(" "),s("section",{directives:[{name:"show",rawName:"v-show",value:t.ftp_div_show,expression:"ftp_div_show"}],staticClass:"flex-100 ftp-div flex-no-border "},[s("section",{staticClass:"ftp-item cms-col10"},[s("div",{staticClass:"cms-col10 "},[s("div",{staticClass:" cms-col1 "},[t._v("\n                步骤\n              ")]),t._v(" "),s("div",{staticClass:"cms-col3"},[t._v("\n                角色\n              ")]),t._v(" "),s("div",{staticClass:"cms-col3"},[t._v("\n                类型\n              ")]),t._v(" "),s("div",{staticClass:"cms-col1"},[t._v("\n                操作\n              ")])]),t._v(" "),t._l(t.setps,function(e,a){return s("div",{key:a,staticClass:"cms-col10 "},[s("div",{staticClass:" cms-col1 "},[t._v("\n                第\n                "+t._s(a+1)+"\n                步\n              ")]),t._v(" "),s("div",{staticClass:"cms-col3"},[s("el-select",{staticClass:"cms-col7",model:{value:t.setps[a].roleId,callback:function(e){t.$set(t.setps[a],"roleId",e)},expression:"setps[index].roleId"}},t._l(t.roles,function(t,e){return s("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),s("div",{staticClass:"cms-col3"},[s("el-radio-group",{staticClass:"cms-col10",model:{value:t.setps[a].countersign,callback:function(e){t.$set(t.setps[a],"countersign",e)},expression:"setps[index].countersign"}},[s("el-radio",{attrs:{label:!0}},[t._v("会签")]),t._v(" "),s("el-radio",{attrs:{label:!1}},[t._v("普通流转")])],1)],1),t._v(" "),s("div",{staticClass:"cms-col1"},[s("cms-button",{attrs:{type:"delete"},nativeOn:{click:function(e){t.setpDelete(a)}}})],1)])}),t._v(" "),s("div",{staticClass:"cms-col10 gray"},[t._v("\n              说明：会签表示需要所选角色中所有用户都审核才能进入下一步，普通流转则只需要其中任意一个用户审核就能进入下一步。\n            ")])],2)]),t._v(" "),s("div",{staticClass:"form-footer"},[t.isType("save")?s("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/workflow/save",expression:"'/workflow/save'"}],attrs:{type:"warning"},on:{click:function(e){t.add(!0)}}},[t._v("\n              提交并继续添加\n            ")]):t._e(),t._v(" "),t.isType("save")?s("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/workflow/save",expression:"'/workflow/save'"}],attrs:{type:"primary"},on:{click:function(e){t.add(!1)}}},[t._v("\n              提交\n            ")]):t._e(),t._v(" "),t.isType("update")?s("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/workflow/update",expression:"'/workflow/update'"}],attrs:{type:"primary"},on:{click:function(e){t.update()}}},[t._v("\n              修改\n            ")]):t._e(),t._v(" "),s("el-button",{attrs:{type:"info"},on:{click:t.reset}},[t._v("重置")]),t._v(" "),t.isType("save")?s("span",{staticClass:"gray"},[t._v("选择“提交并继续添加”按钮会停留在添加页面；选择“提交”按钮后将跳转到对应的列表页")]):t._e()],1)],1)],1)},v=[],f={render:p,staticRenderFns:v},m=f,u=s("Mw9A"),b=a,h=u(c,m,!1,b,"data-v-5eb1ad57",null);e.default=h.exports}});