webpackJsonp([73],{GEok:function(n,e,t){var a=t("s1Q5");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t("8bSs")("5e4e9b52",a,!0)},T36S:function(n,e,t){"use strict";function a(n){t("GEok")}Object.defineProperty(e,"__esModule",{value:!0});var s=t("HzJ8"),r=t.n(s),o=t("a3Yh"),i=t.n(o),l=t("2sCs"),c=t.n(l),d=t("x1ym"),p=t("lcoF"),h={mixins:[p.a],data:function(){var n,e=d.a.required("此项必填");return{rules:(n={name:[e],priority:[e,d.a.number("只能输入数字")]},i()(n,"name",[e]),i()(n,"controlChannelIds",[e]),i()(n,"channelIds",[e]),n),pid:this.$route.query.pid,departments:[],guessbookTypes:[],selectDepartments:[],selectCtgs:[]}},methods:{getControlChannels:function(n){this.dataInfo.controlChannelIds=n},getChannels:function(n){this.dataInfo.channelIds=n},getDataInfo:function(n){var e=this,t=this.$api;c.a.post(t.departmentGet,{id:n}).then(function(n){e.loading=!1,e.dataInfo=n.body,e.selectDepartments=e.pid,0==e.selectDepartments&&(e.selectDepartments=[""]);var t=e.dataInfo.ctgs;if(t.length>0){var a=!0,s=!1,o=void 0;try{for(var i,l=r()(t);!(a=(i=l.next()).done);a=!0){var c=i.value;e.selectCtgs.push(c.id)}}catch(n){s=!0,o=n}finally{try{!a&&l.return&&l.return()}finally{if(s)throw o}}}e.dataInfo.channelIds=e.formateChannelIds(e.dataInfo.channels),e.dataInfo.controlChannelIds=e.formateChannelIds(e.dataInfo.controlChannels),e.getDepartment()}).catch(function(n){e.loading=!1})},formateChannelIds:function(n){var e=[],t=!0,a=!1,s=void 0;try{for(var o,i=r()(n);!(t=(o=i.next()).done);t=!0){var l=o.value;e.push(l.channelId)}}catch(n){a=!0,s=n}finally{try{!t&&i.return&&i.return()}finally{if(a)throw s}}return e},formateControllerChannelIds:function(n){var e=[],t=!0,a=!1,s=void 0;try{for(var o,i=r()(n);!(t=(o=i.next()).done);t=!0){var l=o.value;e.push(l.channelId)}}catch(n){a=!0,s=n}finally{try{!t&&i.return&&i.return()}finally{if(a)throw s}}return e},getGuessbookType:function(){var n=this;c.a.post(this.$api.guestbookTypeList).then(function(e){"200"==e.code&&(n.guessbookTypes=e.body)})},getDepartment:function(){var n=this;c.a.post(this.$api.departmentTree).then(function(e){"200"==e.code&&(e.body.unshift({id:"",name:"根目录",pid:"",priority:0,weights:1}),n.departments=e.body,""!=n.selectDepartments&&n.filterDepartment(n.departments))})},getparam:function(){var n={};return n.name=this.dataInfo.name,n.priority=this.dataInfo.priority,n.channelIds=this.dataInfo.channelIds.join(","),n.controlChannelIds=this.dataInfo.controlChannelIds.join(","),this.selectDepartments.length>0&&(n.pid=this.selectDepartments[this.selectDepartments.length-1]),this.selectCtgs.length>0&&(n.ctgIds=this.selectCtgs.join(",")),n},filterDepartment:function(n){for(var e in n)n[e].id==this.dataInfo.id&&n.splice(e,1)},add:function(n){this.saveDataInfo(n,this.$api.departmentSave,this.getparam(),"/department/list")}},created:function(){this.getDataInfo(this.id),this.getGuessbookType()}},f=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("section",[t("cms-back"),n._v(" "),t("div",{staticClass:"cms-list-header"}),n._v(" "),t("el-form",{ref:"form",staticClass:"cms-form",attrs:{model:n.dataInfo,rules:n.rules,"label-width":"162px"}},[t("el-form-item",{staticClass:"flex-50",attrs:{label:"上级部门",prop:"selectDepartments"}},[t("el-cascader",{staticClass:"cms-width",attrs:{props:{value:"id",label:"name",children:"child"},options:n.departments,"change-on-select":"",filterable:""},model:{value:n.selectDepartments,callback:function(e){n.selectDepartments=e},expression:"selectDepartments"}})],1),n._v(" "),t("el-form-item",{staticClass:"flex-50",attrs:{label:"部门名称",prop:"name"}},[t("el-input",{staticClass:"cms-width",model:{value:n.dataInfo.name,callback:function(e){n.$set(n.dataInfo,"name",e)},expression:"dataInfo.name"}})],1),n._v(" "),t("el-form-item",{staticClass:"flex-50",attrs:{label:"排序",prop:"priority"}},[t("el-input",{staticClass:"cms-width",attrs:{type:"number"},model:{value:n.dataInfo.priority,callback:function(e){n.$set(n.dataInfo,"priority",e)},expression:"dataInfo.priority"}})],1),n._v(" "),t("el-form-item",{staticClass:"flex-50",attrs:{label:"留言审核权限",prop:"ctgs"}},[n.guessbookTypes.length>0?t("el-checkbox-group",{model:{value:n.selectCtgs,callback:function(e){n.selectCtgs=e},expression:"selectCtgs"}},n._l(n.guessbookTypes,function(e,a){return t("el-checkbox",{key:n.guessbookTypes[a].id,attrs:{label:n.guessbookTypes[a].id}},[n._v(n._s(n.guessbookTypes[a].name))])})):n._e()],1),n._v(" "),t("el-form-item",{staticClass:"flex-50",attrs:{label:"栏目权限",prop:"channelIds"}},[t("div",{staticStyle:{"min-height":"400px"}},[t("cms-site-dialog",{ref:"channelTree",attrs:{expandAll:!0,checkIds:n.dataInfo.channelIds,showCheck:"channel",isFilterCurrentSite:!1,isAnsy:!1},on:{change:n.getChannels}})],1)]),n._v(" "),t("el-form-item",{staticClass:"flex-50",attrs:{label:"栏目权限控制",prop:"controlChannelIds"}},[t("div",{staticStyle:{"min-height":"400px"}},[t("cms-site-dialog",{attrs:{expandAll:!0,checkIds:n.dataInfo.controlChannelIds,showCheck:"channel",isFilterCurrentSite:!1,isAnsy:!1},on:{change:n.getControlChannels}})],1)]),n._v(" "),t("div",{staticClass:"form-footer"},[n.isType("save")?t("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/department/save",expression:"'/department/save'"}],attrs:{type:"warning"},on:{click:function(e){n.add(!0)}}},[n._v("保存并继续添加")]):n._e(),n._v(" "),n.isType("save")?t("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/department/save",expression:"'/department/save'"}],attrs:{type:"primary"},on:{click:function(e){n.add(!1)}}},[n._v("提交")]):n._e(),n._v(" "),t("el-button",{attrs:{type:"info"},on:{click:n.reset}},[n._v("重置")]),n._v(" "),n.isType("save")?t("span",{staticClass:"gray"},[n._v("选择“提交并继续添加”按钮会停留在添加页面；选择“提交”按钮后将跳转到对应的列表页")]):n._e()],1)],1)],1)},m=[],u={render:f,staticRenderFns:m},v=u,y=t("Mw9A"),g=a,I=y(h,v,!1,g,null,null);e.default=I.exports},s1Q5:function(n,e,t){e=n.exports=t("BkJT")(!1),e.push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])}});